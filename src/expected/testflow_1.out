create extension cube with version '1.0';
create extension hstore with version '1.1';
create extension flow with version '1.0';
RESET client_min_messages;
RESET log_error_verbosity;
SET client_min_messages = notice;
SET log_error_verbosity = terse;
SELECT '[(1,2,3,4,5,6,7.00)]'::yflow;
             yflow              
--------------------------------
 [(1, 2, 3, 4, 5, 6, 7.000000)]
(1 row)

SELECT yflow_init(ROW(1,1,1,100,'q1',200,'q2',50)::yorder);
              yflow_init              
--------------------------------------
 [(1, 1, 1, 100, 200, 50, -1.000000)]
(1 row)

SELECT yflow_grow(ROW(2,1,2,100,'q2',200,'q1',50)::yorder, ROW(1,1,1,100,'q1',200,'q2',50)::yorder, yflow_init(ROW(1,1,1,100,'q1',200,'q2',50)::yorder) );
                               yflow_grow                               
------------------------------------------------------------------------
 [(2, 2, 1, 100, 200, 50, 1.000000),(1, 1, 1, 100, 200, 50, -1.000000)]
(1 row)

SELECT yflow_finish(ROW(2,1,2,100,'q2',200,'q1',50)::yorder,
yflow_grow(ROW(2,1,2,100,'q2',200,'q1',50)::yorder, ROW(1,1,1,100,'q1',200,'q2',50)::yorder, yflow_init(ROW(1,1,1,100,'q1',200,'q2',50)::yorder) ),
ROW(1,1,1,100,'q1',200,'q2',50)::yorder);
                             yflow_finish                              
-----------------------------------------------------------------------
 [(2, 2, 1, 100, 200, 50, 1.000000),(1, 1, 1, 100, 200, 50, 1.000000)]
(1 row)

SELECT yflow_dim(yflow_init(ROW(1,1,2,100,'q1',200,'q2',50)::yorder));
 yflow_dim 
-----------
         1
(1 row)

SELECT yflow_contains_oid(1,yflow_init(ROW(1,1,2,100,'q1',200,'q2',50)::yorder));
 yflow_contains_oid 
--------------------
 f
(1 row)

SELECT yflow_contains_oid(2,yflow_init(ROW(1,1,2,100,'q1',200,'q2',50)::yorder));
 yflow_contains_oid 
--------------------
 t
(1 row)

select yflow_is_draft('[(35, 93, 35, 21170, 2685, 2685, 1.000000),(636, 50, 636, 12213, 95415, 95415, 1.000000
),(389, 68, 389, 23785, 29283, 29283, 1.000000),(274, 12, 274, 58834, 80362, 80362, 1.000000),(12, 
55, 12, 35136, 55490, 55490, 1.000000)]'::yflow);
 yflow_is_draft 
----------------
 t
(1 row)

select yflow_reduce(x.f1,x.f1) from (select '[(35, 93, 35, 21170, 2685, 2685, 1.000000),(636, 50, 636, 12213, 95415, 95415, 1.000000
),(389, 68, 389, 23785, 29283, 29283, 1.000000),(274, 12, 274, 58834, 80362, 80362, 1.000000),(12, 
55, 12, 35136, 55490, 55490, 1.000000)]'::yflow as f1) x;
                                                                                                          yflow_reduce                                                                                                          
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [(35, 93, 35, 21170, 2685, 0, 1.000000),(636, 50, 636, 12213, 95415, 78129, 1.000000),(389, 68, 389, 23785, 29283, 11746, 1.000000),(274, 12, 274, 58834, 80362, 60622, 1.000000),(12, 55, 12, 35136, 55490, 29800, 1.000000)]
(1 row)

select yflow_show('[(35, 93, 35, 21170, 2685, 2685, 1.000000),(636, 50, 636, 12213, 95415, 95415, 1.000000
),(389, 68, 389, 23785, 29283, 29283, 1.000000),(274, 12, 274, 58834, 80362, 80362, 1.000000),(12, 
55, 12, 35136, 55490, 55490, 1.000000)]'::yflow);
                                                                                                                                yflow_show                                                                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 YFLOW [(35, 93, 35, 21170, 2685, 2685, 1.000000 :2685),(636, 50, 636, 12213, 95415, 95415, 1.000000 :17286),(389, 68, 389, 23785, 29283, 29283, 1.000000 :17537),(274, 12, 274, 58834, 80362, 80362, 1.000000 :19740),(12, 55, 12, 35136, 55490, 55490, 1.000000 :25690)]+
 
(1 row)

select yflow_to_matrix('[(35, 93, 35, 21170, 2685, 2685, 1.000000),(636, 50, 636, 12213, 95415, 95415, 1.000000
),(389, 68, 389, 23785, 29283, 29283, 1.000000),(274, 12, 274, 58834, 80362, 80362, 1.000000),(12, 
55, 12, 35136, 55490, 55490, 1.000000)]'::yflow);
                                                                                   yflow_to_matrix                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {{35,35,93,21170,2685,2685,2685},{636,636,50,12213,95415,95415,17286},{389,389,68,23785,29283,29283,17537},{274,274,12,58834,80362,80362,19740},{12,12,55,35136,55490,55490,25690}}
(1 row)

select yflow_show('[(35, 93, 35, 21170, 2685, 2685, 1.000000),(636, 50, 636, 12213, 95415, 95415, 1.000000
),(389, 68, 389, 23785, 29283, 29283, 1.000000),(274, 12, 274, 58834, 80362, 80362, 1.000000),(12, 
55, 12, 35136, 55490, 55490, 1.000000)]'::yflow);
                                                                                                                                yflow_show                                                                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 YFLOW [(35, 93, 35, 21170, 2685, 2685, 1.000000 :2685),(636, 50, 636, 12213, 95415, 95415, 1.000000 :17286),(389, 68, 389, 23785, 29283, 29283, 1.000000 :17537),(274, 12, 274, 58834, 80362, 80362, 1.000000 :19740),(12, 55, 12, 35136, 55490, 55490, 1.000000 :25690)]+
 
(1 row)

select yflow_qtts('[(35, 93, 35, 21170, 2685, 2685, 1.000000),(636, 50, 636, 12213, 95415, 95415, 1.000000
),(389, 68, 389, 23785, 29283, 29283, 1.000000),(274, 12, 274, 58834, 80362, 80362, 1.000000),(12, 
55, 12, 35136, 55490, 55490, 1.000000)]'::yflow);
  yflow_qtts   
---------------
 {19740,25690}
(1 row)

select yflow_show('[(62, 62, 6, 49210, 60487, 55111, 1.000000),(64, 64, 4, 64784, 55162, 53296, 1.000000),(52, 52, 14, 34697, 57236, 56208, 1.000000),(86, 86, 11, 19239, 28465, 27569, 1.000000),(87, 87, 4, 20786, 61473, 60554, 1.000000),(33, 33, 16, 828, 12515, 12515, 1.000000),(1, 1, 1, 35542, 66945, 17677, 1.000000),(102, 102, 15, 87633, 69633, 33223, 1.000000)]'::yflow);
                                                                                                                                                                                                     yflow_show                                                                                                                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 YFLOW [(62, 62, 6, 49210, 60487, 55111, 1.000000 :2543),(64, 64, 4, 64784, 55162, 53296, 1.000000 :1500),(52, 52, 14, 34697, 57236, 56208, 1.000000 :1187),(86, 86, 11, 19239, 28465, 27569, 1.000000 :843),(87, 87, 4, 20786, 61473, 60554, 1.000000 :1726),(33, 33, 16, 828, 12515, 12515, 1.000000 :12515),(1, 1, 1, 35542, 66945, 17677, 1.000000 :11310),(102, 102, 15, 87633, 69633, 33223, 1.000000 :4312)]+
 
(1 row)

select yflow_qtts('[(62, 62, 6, 49210, 60487, 55111, 1.000000),(64, 64, 4, 64784, 55162, 53296, 1.000000),(52, 52, 14, 34697, 57236, 56208, 1.000000),(86, 86, 11, 19239, 28465, 27569, 1.000000),(87, 87, 4, 20786, 61473, 60554, 1.000000),(33, 33, 16, 828, 12515, 12515, 1.000000),(1, 1, 1, 35542, 66945, 17677, 1.000000),(102, 102, 15, 87633, 69633, 33223, 1.000000)]'::yflow);
  yflow_qtts  
--------------
 {11310,4312}
(1 row)

